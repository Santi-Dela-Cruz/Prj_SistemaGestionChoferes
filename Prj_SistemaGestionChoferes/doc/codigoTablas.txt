CREATE TABLE `administrador` (
	`admin_id` INT(10) NOT NULL AUTO_INCREMENT,
	`admin_usuario` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`admin_nombre` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`admin_apellido` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`admin_correo` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`admin_contrasena` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`admin_fecha_ingreso` DATE NOT NULL,
	`admin_hora_ingreso` TIME NOT NULL,
	`admin_cargo` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`admin_telefono` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`admin_direccion` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`estado` CHAR(1) NOT NULL DEFAULT 'A' COLLATE 'utf8mb4_spanish_ci',
	PRIMARY KEY (`admin_id`) USING BTREE,
	UNIQUE INDEX `unq_admin_correo` (`admin_correo`, `admin_contrasena`, `admin_usuario`, `admin_telefono`) USING BTREE,
	CONSTRAINT `chk_admin_estado` CHECK ((`estado` in (_utf8mb4\'A\',_utf8mb4\'X\')))
)
COLLATE='utf8mb4_spanish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=3
;


CREATE TABLE `chofer` (
	`chofer_id` INT(10) NOT NULL AUTO_INCREMENT,
	`chofer_cedula` VARCHAR(10) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`chofer_nombre` VARCHAR(100) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`chofer_apellido` VARCHAR(100) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`chofer_telefono` VARCHAR(10) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`chofer_direccion` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`chofer_correo` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`chofer_categoria_licencia` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`chofer_fecha_vencimiento_licencia` DATE NOT NULL,
	`estado` CHAR(1) NOT NULL DEFAULT 'A' COLLATE 'utf8mb4_spanish_ci',
	PRIMARY KEY (`chofer_id`) USING BTREE,
	UNIQUE INDEX `unq_chofer_identificacion` (`chofer_cedula`, `chofer_telefono`, `chofer_correo`) USING BTREE,
	CONSTRAINT `chk_chofer_estado` CHECK ((`estado` in (_utf8mb4\'A\',_utf8mb4\'X\')))
)
COLLATE='utf8mb4_spanish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=4
;


CREATE TABLE `huella_digital` (
	`huella_id` INT(10) NOT NULL AUTO_INCREMENT,
	`chofer_id` INT(10) NOT NULL,
	`huella_codigo` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`estado` CHAR(1) NOT NULL DEFAULT 'A' COLLATE 'utf8mb4_spanish_ci',
	PRIMARY KEY (`huella_id`) USING BTREE,
	UNIQUE INDEX `unq_huella_codigo` (`huella_codigo`) USING BTREE,
	INDEX `idx_huella_chofer` (`chofer_id`) USING BTREE,
	CONSTRAINT `fk_huella_chofer` FOREIGN KEY (`chofer_id`) REFERENCES `chofer` (`chofer_id`) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT `chk_huella_estado` CHECK ((`estado` in (_utf8mb4\'A\',_utf8mb4\'X\')))
)
COLLATE='utf8mb4_spanish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=4
;


CREATE TABLE `modificacion` (
	`modificacion_id` INT(10) NOT NULL AUTO_INCREMENT,
	`admin_id` INT(10) NOT NULL,
	`chofer_id_modificado` INT(10) NOT NULL,
	`modificacion_fecha` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`modificacion_hora` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`modificacion_accion` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`estado` CHAR(1) NOT NULL DEFAULT 'A' COLLATE 'utf8mb4_spanish_ci',
	PRIMARY KEY (`modificacion_id`) USING BTREE,
	INDEX `idx_modificacion_admin` (`admin_id`) USING BTREE,
	INDEX `idx_modificacion_chofer` (`chofer_id_modificado`) USING BTREE,
	CONSTRAINT `fk_modificacion_admin` FOREIGN KEY (`admin_id`) REFERENCES `administrador` (`admin_id`) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT `fk_modificacion_chofer` FOREIGN KEY (`chofer_id_modificado`) REFERENCES `chofer` (`chofer_id`) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT `chk_modificacion_estado` CHECK ((`estado` in (_utf8mb4\'A\',_utf8mb4\'X\')))
)
COLLATE='utf8mb4_spanish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=35
;


CREATE TABLE `penalizacion` (
	`penalizacion_id` INT(10) NOT NULL AUTO_INCREMENT,
	`chofer_id` INT(10) NOT NULL,
	`infracciones` INT(10) NOT NULL,
	`penalizacion_detalle` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`estado` CHAR(1) NOT NULL DEFAULT 'A' COLLATE 'utf8mb4_spanish_ci',
	PRIMARY KEY (`penalizacion_id`) USING BTREE,
	INDEX `idx_penalizacion_chofer` (`chofer_id`) USING BTREE,
	CONSTRAINT `fk_penalizacion_chofer` FOREIGN KEY (`chofer_id`) REFERENCES `chofer` (`chofer_id`) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT `chk_penalizacion_estado` CHECK ((`estado` in (_utf8mb4\'A\',_utf8mb4\'X\')))
)
COLLATE='utf8mb4_spanish_ci'
ENGINE=InnoDB
;


CREATE TABLE `registro_estado` (
	`registro_estado_id` INT(10) NOT NULL AUTO_INCREMENT,
	`chofer_id` INT(10) NOT NULL,
	`autorizacion` TINYINT(1) NOT NULL,
	`registro_fecha` DATE NOT NULL,
	`registro_hora` TIME NOT NULL,
	`estado` CHAR(1) NOT NULL DEFAULT 'A' COLLATE 'utf8mb4_spanish_ci',
	PRIMARY KEY (`registro_estado_id`) USING BTREE,
	INDEX `idx_registro_estado_chofer` (`chofer_id`) USING BTREE,
	CONSTRAINT `fk_registro_estado_chofer` FOREIGN KEY (`chofer_id`) REFERENCES `chofer` (`chofer_id`) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT `chk_registro_estado` CHECK ((`estado` in (_utf8mb4\'A\',_utf8mb4\'X\')))
)
COLLATE='utf8mb4_spanish_ci'
ENGINE=InnoDB
;


CREATE TABLE `ruta` (
	`ruta_id` INT(10) NOT NULL AUTO_INCREMENT,
	`chofer_id` INT(10) NOT NULL,
	`ruta_nombre` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`estado` CHAR(1) NOT NULL DEFAULT 'A' COLLATE 'utf8mb4_spanish_ci',
	PRIMARY KEY (`ruta_id`) USING BTREE,
	UNIQUE INDEX `unq_ruta_nombre` (`ruta_nombre`) USING BTREE,
	INDEX `idx_ruta_chofer` (`chofer_id`) USING BTREE,
	CONSTRAINT `fk_ruta_chofer` FOREIGN KEY (`chofer_id`) REFERENCES `chofer` (`chofer_id`) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT `chk_ruta_estado` CHECK ((`estado` in (_utf8mb4\'A\',_utf8mb4\'X\')))
)
COLLATE='utf8mb4_spanish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=4
;


CREATE TABLE `vehiculo` (
	`vehiculo_id` INT(10) NOT NULL AUTO_INCREMENT,
	`chofer_id` INT(10) NOT NULL,
	`vehiculo_placa` VARCHAR(8) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`vehiculo_tipo` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`vehiculo_marca` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`vehiculo_modelo` VARCHAR(50) NOT NULL COLLATE 'utf8mb4_spanish_ci',
	`estado` CHAR(1) NOT NULL DEFAULT 'A' COLLATE 'utf8mb4_spanish_ci',
	PRIMARY KEY (`vehiculo_id`) USING BTREE,
	UNIQUE INDEX `unq_vehiculo_placa` (`vehiculo_placa`) USING BTREE,
	INDEX `idx_vehiculo_chofer` (`chofer_id`) USING BTREE,
	CONSTRAINT `fk_vehiculo_chofer` FOREIGN KEY (`chofer_id`) REFERENCES `chofer` (`chofer_id`) ON UPDATE NO ACTION ON DELETE NO ACTION,
	CONSTRAINT `chk_vehiculo_estado` CHECK ((`estado` in (_utf8mb4\'A\',_utf8mb4\'X\')))
)
COLLATE='utf8mb4_spanish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=4
;

//////////////////////////////////////////SQLITE////////////////////////////////

CREATE TABLE administrador (
    admin_id INTEGER PRIMARY KEY AUTOINCREMENT,
    admin_usuario VARCHAR(50) NOT NULL,
    admin_nombre VARCHAR(50) NOT NULL,
    admin_apellido VARCHAR(50) NOT NULL,
    admin_correo VARCHAR(50) NOT NULL,
    admin_contrasena VARCHAR(50) NOT NULL,
    admin_fecha_ingreso DATE NOT NULL,
    admin_hora_ingreso TIME NOT NULL,
    admin_cargo VARCHAR(50) NOT NULL,
    admin_telefono VARCHAR(50) NOT NULL,
    admin_direccion VARCHAR(50) NOT NULL,
    estado CHAR(1) DEFAULT 'A' CHECK (estado IN ('A', 'X')),
    UNIQUE(admin_correo, admin_contrasena, admin_usuario, admin_telefono),
    CONSTRAINT chk_admin_estado CHECK (estado IN ('A', 'X'))
);

CREATE TABLE chofer (
    chofer_id INTEGER PRIMARY KEY AUTOINCREMENT,
    chofer_cedula VARCHAR(10) NOT NULL,
    chofer_nombre VARCHAR(100) NOT NULL,
    chofer_apellido VARCHAR(100) NOT NULL,
    chofer_telefono VARCHAR(10) NOT NULL,
    chofer_direccion VARCHAR(50) NOT NULL,
    chofer_correo VARCHAR(50) NOT NULL,
    chofer_categoria_licencia VARCHAR(50) NOT NULL,
    chofer_fecha_vencimiento_licencia DATE NOT NULL,
    estado CHAR(1) DEFAULT 'A' CHECK (estado IN ('A', 'X')),
    UNIQUE(chofer_cedula, chofer_telefono, chofer_correo),
    CONSTRAINT chk_chofer_estado CHECK (estado IN ('A', 'X'))
);

CREATE TABLE huella_digital (
    huella_id INTEGER PRIMARY KEY AUTOINCREMENT,
    chofer_id INTEGER NOT NULL,
    huella_codigo VARCHAR(50) NOT NULL,
    estado CHAR(1) DEFAULT 'A' CHECK (estado IN ('A', 'X')),
    UNIQUE(huella_codigo),
    CONSTRAINT fk_huella_chofer FOREIGN KEY (chofer_id) REFERENCES chofer (chofer_id),
    CONSTRAINT chk_huella_estado CHECK (estado IN ('A', 'X'))
);

CREATE TABLE modificacion (
    modificacion_id INTEGER PRIMARY KEY AUTOINCREMENT,
    admin_id INTEGER NOT NULL,
    chofer_id_modificado INTEGER NOT NULL,
    modificacion_fecha VARCHAR(50) NOT NULL,
    modificacion_hora VARCHAR(50) NOT NULL,
    modificacion_accion VARCHAR(50) NOT NULL,
    estado CHAR(1) DEFAULT 'A' CHECK (estado IN ('A', 'X')),
    CONSTRAINT fk_modificacion_admin FOREIGN KEY (admin_id) REFERENCES administrador (admin_id),
    CONSTRAINT fk_modificacion_chofer FOREIGN KEY (chofer_id_modificado) REFERENCES chofer (chofer_id),
    CONSTRAINT chk_modificacion_estado CHECK (estado IN ('A', 'X'))
);

CREATE TABLE penalizacion (
    penalizacion_id INTEGER PRIMARY KEY AUTOINCREMENT,
    chofer_id INTEGER NOT NULL,
    infracciones INTEGER NOT NULL,
    penalizacion_detalle VARCHAR(50) NOT NULL,
    estado CHAR(1) DEFAULT 'A' CHECK (estado IN ('A', 'X')),
    CONSTRAINT fk_penalizacion_chofer FOREIGN KEY (chofer_id) REFERENCES chofer (chofer_id),
    CONSTRAINT chk_penalizacion_estado CHECK (estado IN ('A', 'X'))
);

CREATE TABLE registro_estado (
    registro_estado_id INTEGER PRIMARY KEY AUTOINCREMENT,
    chofer_id INTEGER NOT NULL,
    estado_chofer VARCHAR(50) DEFAULT NULL,
    autorizacion INTEGER NOT NULL,
    registro_fecha DATE NOT NULL,
    registro_hora TIME NOT NULL,
    estado CHAR(1) DEFAULT 'A' CHECK (estado IN ('A', 'X')),
    CONSTRAINT fk_registro_estado_chofer FOREIGN KEY (chofer_id) REFERENCES chofer (chofer_id),
    CONSTRAINT chk_registro_estado CHECK (estado IN ('A', 'X'))
);

CREATE TABLE ruta (
    ruta_id INTEGER PRIMARY KEY AUTOINCREMENT,
    chofer_id INTEGER NOT NULL,
    ruta_nombre VARCHAR(50) NOT NULL,
    estado CHAR(1) DEFAULT 'A' CHECK (estado IN ('A', 'X')),
    UNIQUE(ruta_nombre),
    CONSTRAINT fk_ruta_chofer FOREIGN KEY (chofer_id) REFERENCES chofer (chofer_id),
    CONSTRAINT chk_ruta_estado CHECK (estado IN ('A', 'X'))
);

CREATE TABLE vehiculo (
    vehiculo_id INTEGER PRIMARY KEY AUTOINCREMENT,
    chofer_id INTEGER NOT NULL,
    vehiculo_placa VARCHAR(8) NOT NULL,
    vehiculo_tipo VARCHAR(50) NOT NULL,
    vehiculo_marca VARCHAR(50) NOT NULL,
    vehiculo_modelo VARCHAR(50) NOT NULL,
    estado CHAR(1) DEFAULT 'A' CHECK (estado IN ('A', 'X')),
    UNIQUE(vehiculo_placa),
    CONSTRAINT fk_vehiculo_chofer FOREIGN KEY (chofer_id) REFERENCES chofer (chofer_id),
    CONSTRAINT chk_vehiculo_estado CHECK (estado IN ('A', 'X'))
);
